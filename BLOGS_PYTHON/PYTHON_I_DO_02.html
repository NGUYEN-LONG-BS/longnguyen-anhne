<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <!-- google font -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
          href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;500&display=swap"
          rel="stylesheet"
        />
        <!-- main css -->
        <link rel="stylesheet" href="../css/main.css" />
        <title>PYTHON TUTORIAL</title>
      </head>
      <body>
        <!-- overlay -->
        <section id="overlay"></section>
        <!-- header -->
        <header>
          <div class="container">
            <nav class="navbar">
              <!-- logo -->
              <div class="navbar__logo">
                <a href="index.html">
                  <img src="../img/logo.png" alt="website logo">
                </a>
              </div>
              <!-- links -->
              <ul class="navbar__links">
                <li class="navbar__link"><a href="../ACCA.html">ACCA</a></li>
                <li class="navbar__link"><a href="../CFA.html">CFA</a></li>
                <li class="navbar__link"><a href="../VBA.html">VBA</a></li>
                <li class="navbar__link"><a href="../python.html">PYTHON</a></li>
                <li class="navbar__link"><a href="../python.html">SQL</a></li>
                <li class="navbar__link"><a href="../JAVASCRIPT.html">JAVASCRIPT</a></li>
                <a href="#footer"><button class="navbar__btn">Contact</button></a>
              </ul>
              <!-- menu button -->
              <div class="navbar__icons">
                <div class="navbar__icon"></div>
              </div>
            </nav>
          </div>
        </header>
        
        <P>Đề bài:</P>
        <P>Chúng ta có cơ sở dữ liệu SQL Server, chúng ta cần lấy dữ liệu từ bảng TB_DS_DATABASE ra file Excel (đường link tuỳ chỉnh)</P>
        <P><code class="prettify">import pyodbc</code></P>
        <P><code class="prettify">conn = pyodbc.connect('Server=KSNB3\SQLEXPRESS;Database=DATABASE_USER_ID;Trusted_Connection=True;PORT=1433;DRIVER={SQL Server}')</code></P>
        <p><code class="prettify">cursor = conn.cursor()</code></p>
        <p><code class="prettify">cursor.execute('Select * from TB_DS_DATABASE')</code></p>
        <p><code class="prettify">rows = cursor.fetchall()</code></p>
        <p><code class="prettify"># print(rows)</code></p>
        <p><code class="prettify">cursor.close()</code></p>
        <p><code class="prettify">conn.close()</code></p>
        <p><code class="prettify">import xlwings as xw    # Thư viện chuyên dùng để xử lý Excel</code></p>
        <p><code class="prettify">from openpyxl import load_workbook, Workbook</code></p>
        <p><code class="prettify">import pandas as pd</code></p>
        <p><code class="prettify"># Load in the workbook</code></p>
        <p><code class="prettify"># excel_path = 'C:\Users\ADMIN\Desktop\OUTPUT.xlsx'</code></p>
        <p><code class="prettify">df = pd.read_excel(r'C:\Users\ADMIN\Desktop\OUTPUT.xlsx')</code></p>
        <p><code class="prettify"># df = pd</code></p>
        <p><code class="prettify"># Convert the fetched rows to a DataFrame</code></p>
        <p><code class="prettify"># File Excel phải đang đóng</code></p>
        <p><code class="prettify">df2 = pd.DataFrame(rows)</code></p>
        <p><code class="prettify">print(df2)</code></p>    
        <P><code class="prettify">df2.to_excel(r'C:\Users\ADMIN\Desktop\OUTPUT.xlsx', index=False)</code></P>
        
        <!-- footer -->
        <footer id="footer">
          <div class="container">
            <!-- dec -->
            <div class="footer__dec">
              <img src="./img/things-dec-l.png" alt="illustration of leaf" />
            </div>
            <!-- img -->
            <div class="footer__img">
              <img src="./img/footer-img.png" alt="illustration of women" />
            </div>
            <!-- heading -->
            <div class="footer__heading">
              <h1>Ready to make something amazing?</h1>
              <!-- contact -->
              <div class="footer__contact">
                <a href="tel:0932782603">
                  <i class="fas fa-phone-alt"></i>
                  <p>0932 782 603</p>
                </a>
                <a href="mailto:nguyenlongbs2012@gmail.com">
                  <i class="fas fa-envelope"></i>
                  <p>nguyenlongbs2012@gmail.com</p>
                </a>
              </div>
              <div class="banner__socials">
                <a href="#"><i class="fab fa-dribbble"></i></a>
                <a href="#"><i class="fab fa-behance"></i></a>
                <a href="#"><i class="fab fa-linkedin-in"></i></a>
                <a href="https://www.facebook.com/nguyenlongbs"><i class="fab fa-facebook"></i></a>
              </div>
            </div>
          </div>
        </footer>
        <!-- fontawesome -->
        <script
          src="https://kit.fontawesome.com/28c0af3030.js"
          crossorigin="anonymous"
        ></script>
        <!-- main js -->
        <script src="./js/main.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
      </body>
</html>


