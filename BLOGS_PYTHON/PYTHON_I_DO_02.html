
<P>Đề bài:</P>
<P>Chúng ta có cơ sở dữ liệu SQL Server, chúng ta cần lấy dữ liệu từ bảng TB_DS_DATABASE ra file Excel (đường link tuỳ chỉnh)</P>
    <P><code>import pyodbc</code></P>
    <P><code>conn = pyodbc.connect('Server=KSNB3\SQLEXPRESS;Database=DATABASE_USER_ID;Trusted_Connection=True;PORT=1433;DRIVER={SQL Server}')</code></P>
    <p><code>cursor = conn.cursor()</code></p>
    <p><code>cursor.execute('Select * from TB_DS_DATABASE')</code></p>
    <p><code>rows = cursor.fetchall()</code></p>
    <p><code># print(rows)</code></p>
    <p><code>cursor.close()</code></p>
    <p><code>conn.close()</code></p>
    <p><code>import xlwings as xw    # Thư viện chuyên dùng để xử lý Excel</code></p>
    <p><code>from openpyxl import load_workbook, Workbook</code></p>
    <p><code>import pandas as pd</code></p>
    <p><code># Load in the workbook</code></p>
    <p><code># excel_path = 'C:\Users\ADMIN\Desktop\OUTPUT.xlsx'</code></p>
    <p><code>df = pd.read_excel(r'C:\Users\ADMIN\Desktop\OUTPUT.xlsx')</code></p>
    <p><code># df = pd</code></p>
    <p><code># Convert the fetched rows to a DataFrame</code></p>
    <p><code># File Excel phải đang đóng</code></p>
    <p><code>df2 = pd.DataFrame(rows)</code></p>
    <p><code>print(df2)</code></p>    
    <P><code>df2.to_excel(r'C:\Users\ADMIN\Desktop\OUTPUT.xlsx', index=False)</code></P>
        